<?php
function verificarTentativasArquivo($ip, $tentativasPermitidas = 5) {
    $arquivo = __DIR__ . '/tentativas_logs.txt';

    if (!file_exists($arquivo)) {
        file_put_contents($arquivo, json_encode([]));
    }

    $tentativas = json_decode(file_get_contents($arquivo), true) ?? [];

    foreach ($tentativas as $t) {
        if ($t['ip'] === $ip && !empty($t['bloqueado'])) {
            die(" 
                <!DOCTYPE html>
                <html lang='pt-br'>
                <head>
                    <meta charset='UTF-8'>
                    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
                    <title>Acesso Bloqueado</title>
                </head>
                <body>
                    <script>
                            console.log(`%c----------------------------------------------------------------------------------------------------
                            ----------------------------------------------------------------------------------------------------
                            ----------------------------------------------------------------------------------------------------
                            ----------------------------------------------------------------------------------------------------
                            -------------------------*--------------------------------------------------------------------------
                            -------------------------=***-----------------------------------------------------------------------
                            ------------------------+-****++--------------------------------------------------------------------
                            ------------------------=*+******#**++--------------------------------------------------------------
                            -------------------------+************#%+=----------------------------------------------------------
                            ---------------+----------+**************#%==*------------------------------------------------------
                            ---------------##---+=-----*****************##*%=---------------------------------------------------
                            ---------------+#**-=****=-=******************###+--------------------------------------------------
                            ----------------%#**=#******##*******************#*=------------------------------------------------
                            ----------------%%##***#*****##*******************#=*-----------------------------------------------
                            ----------------#%%%##*####****#*********************=----------------------------------------------
                            ----------------#%%%%#*#%%%##**##*********************----------------------------------------------
                            ---------------+#%%%%%%#%%%%%%#####*******************#---------------------------------------------
                            ---------------++%%%%%%%%%%%%%%##%##*******************+--------------------------------------------
                            -----------------%%%%%%%%%%%%%%%%%%%*******************#--------------------------------------------
                            -----------------#%%%%%%%%%%%%%%%%%%#*******************+-------------------------------------------
                            ----------------*+%%%%%%%%%%%%%%%%%%#********************-------------------------------------------
                            ------------------#%%%%%%%%%%%%%%%%%#********************=------------------------------------------
                            ----------------+==%%%%%%%%%%%%%%%%%%*********************------------------------------------------
                            -----------------%++%%%%%%%%%%%%%%%%%#********************------------------------------------------
                            -----------------#%%%%%%%%%%%%%%%%%%%#********************-+=---------------------------------------
                            -----------------=%%%%%%%%%%%%%%%%%%%#***#####************=#----------------------------------------
                            ------------------+%%%%%%%%%%%%%%%%%%#***####************##%----------------------------------------
                            ------------------=*%%%%%%%%%%%%%%%%%#**####***##******#%%%*-=--------------------------------------
                            -------------------=+%%%%%%%%%%%%%%%%#*#####*####****#%%%%%*#+--------------------------------------
                            ------------------+---%%%%%%%%%%%%%%%#*######%%#***##%%##%%%*---------------------------------------
                            -------------------#=--#%%%%%%%%%%%%%###%###%%#*##%%%#*--=#-----------------------------------------
                            --------------------+%**#%%%%%%%%%%%%#%%%#%%%*##%%%%%-----------------------------------------------
                            -------------------*-=%%#%%%%%%%%%%%%%%%#%%%##%%%%*=-------=----------------------------------------
                            --------------------*+-*%%%%%%%%%%%%%%%%%%%##%%%+---+-------+---------------------------------------
                            ---------------------==+**%%%%%%%%%%%%%%%%%###+------=-=-==-----------------------------------------
                            -----------------------=+#%%%%%%%%%%%%%%%#+#+-------:-=---:--+--------------------------------------
                            -------------------------=+#%%%%%#%%%%%%*++=---:----::----*-----------------------------------------
                            -------------------------==+#%%%%%**#%#++=:-------------=----==-------------------------------------
                            --------------------------+++++*%%%%%#++=--:----:---------:--:--------------------------------------
                            --------------------------++++++++++++++---------===--:-=-=-==-=------------------------------------
                            --------------------------+++++++++++++=-:------=-----:--+::::-+------------------------------------
                            --------------------------+++++++++++++=:------=-+***%*==--==--=------------------------------------
                            --------------------------=++++++++++++=------:=%*==-=+=------=+------------------------------------
                            ---------------------------++++++++++++=:-----+#--::::::--+----+=-----------------------------------
                            ---------------------------++++++++++++=:--:-*#=-------:----*-+++-----------------------------------
                            --------------------------++++++++++++++:-:-%#=--:---:-----*==-+------------------------------------
                            --------------------------=+++++++++++==---%%*++---===-:----=---=-----------------------------------
                            --------------------------=#####+++++===-:##***=*##*##-------==-==:::..:----------------------------
                            --------------------------=*++*#%##+=-+:-=++**+*=%#=---:-----=+--*-----:::=-------------------------
                            --------------------------=-+++++**%#**::-=++*+-++*=----------====+++=----:-------------------------
                            ---------------------------#++++==+***+--:==-===--------------=---@@@@@@%=-.+-----------------------
                            ---------------------------=+*+=+=+***+:::-===----------------=--+%@@@@@@@*-.+----------------------
                            ----------------------------=++%#@%%+*+:-----:-:::--::---------+-=%-===@@@@%..----------------------
                            -----------------------------+#-=%#===+----:-:----------------=--:+----=+@@@..----------------------
                            ----------------------------=+***=--=++::---=-:--------------=+--:+----===%@..----------------------
                            ----------------------------*=++++=====+---------------------=++-:=---=====#..----------------------
                            ----------------------------%=+++++====*:----:::------------=-*==*----=====-..----------------------
                            ----------------------------#=++++===-=*--:-------------------=-------=====...----------------------
                            ----------------------------===-------+---:-----------------=-=-------=====..+----------------------
                            -----------------------------=+------=*--------------------=--=-------====..:-----------------------
                            ---------------------------#%=+=-----=+-:------=----------==-:+-------==+..:------------------------
                            --------------------*=--=#%@%=++=---=++-:-:-++-+:--------==:-:=------===...--+----------------------
                            ------------------=+---*@@@@%%=++====+#=-:-*=-+--------:-=-:-:+------==...---=----------------------
                            ----------------=+---*@@@@@@#-==+++++++=-++=:::-:::----:--:---+----==:..:---------------------------
                            --------------=#---+@@@@@@#-----=+++++++++++---:--------------+=--+-...:----+-----------------------
                            -------------*----@@@@@@%-------==+++++++=++-----------------+*#--=...------+-----------------------
                            -----------*----%@@@@@@=---------+-+++++==+=---------:-------+%+---:.+------*-----------------------
                            ----------=---#@@@@@@+=----------=-==+++=-=-=**=--=++--------+==-=----------+-----------------------
                            --------*---+%@@@@@*===------------=+=++==++======*=--------=++%-#--=-------------------------------
                            ------=+---*@@@@@#=====------------+=++++++=++++++-=--------++==-*--=-------------------------------
                            -----=----%@@@@@=======-------------+=###*+#++===:-=-------=+==+=*--=--------+=---------------------
                            -----*----@@@@@@=========------------==+*+++======+--------*++--+#--:--------+=*=-------------------
                            -----*---+@@@@@#=========-=-----------=-*+++=====*--------++++--+*--..:-----==---=:-----------------
                            -----+---%@@@@@===========---------------+=+**++-:--------++*-----=-..+-----==---.------------------
                            ---------*@@@@@+=============------------+++++=--=+*:----+++#-----==..-----====-+.:*+---------------
                            -------=--#@@@@@+============-----------==++=---:-:-:---=++++-----*=..:----+==+-=..-.+--------------
                            --------=--+****-*===========----------=--++-:-:--------*+++=-----*-..:---+==+=-=.::..=-------------
                            ---------=--------*============-------+--+=+--------:--+++++------+=:.:---+=+==-=.::..+-------------
                            ----------*--------*===========-----=+--=+*-=-------::+*+++*------==:..--+=++-==+..-..:::+----------
                            -----------+=-------+===========----+---*+++=-------:=*++++--------=-:.--=++-==:..:-..-..+-=--------
                            -------------*------+=============-+---*++++*=--::--**=++++--------=-:=-==+=-=-:..-..:::.---==------
                            --------------=-----+=============+----+++++-=#++=+*+--+++=--------+---==+=-==-..==..:-..-----+-----
                            ---------------=----++===========+----++++++=-+++*+==-++++--:------+-:-+++--=+..--:.=::..+-----==---
                            -----------------=---=*=========*-----=++++++--+++++==++*----------=-:-++--==...-=..=--.:--------=+-
                            ---------------+-==----+=======*------=++++++=-+++++++++*----:-----=---+--===..-:-..+::.-----------+
                            ----------------=+==----*=======------+++++++++++++++++#-----------==--+--=+...:::..:*.::----------+
                            -------------+-++===.----=+====------==++++++++++++++++=-----------*=-:--===..::+..+:..:------------
                            -----------+-=++===-.-*:-------------+++++++++++++++++=-----------+#=----=+...-:-..:.::------------*
                            --------#=-=++=====::::=------------#*#+++++++++++++++------------%%=-:--==...:-..::=.-:-----------+
                            -----=====+++=====+.*:.*------------%*%-=+===+#++++++-----------*@*@----==-..*:+..=::.:-----------+-
                            ------=+++++=======::=.-:+---------*@%@+-::----+*++++----------*@*%*-:--=*..::.:.::...-----------+--
                            ---==++++++=---===:-::.-+.+--------%@%@@=::------+++====------#@*@@+---==-..:::..::-.::---------*---
                            ----+++++++=----=*.=-..-:.:=-------@@%@@@+----:---:---===#=--%@*@@@--:-==:..*:#..=::.----------*----
                            --==+++++++=---=-=.--.::=.:=------%@@%@@@@@-::----------====%@#@@@@----=%..::....::..:--------*-----
                            --:++++++++=---=-:=:-.=-.-.=----:-@@@%@@@@@@%-:------::-:*%%@@*@@@#---==-..::...=:...--------=------
                            ---++++++++------:--..-*.:.*----:=@@@%@@@@@@@@%#+::--:=#%@@@@*@@@@=---==:..=:+..-.:.::------=-------
                            -=-++++++++=----=.=-..::.=.#---:-@@@@*@@@@@@@@@@@@@%@@@@@@@@*@@@@@=--==#...:.+..-::.=------=--------
                            -+-++++#+++=----#.=-..:-.-.=---:=@@@@*@@@@@@@@@@@@@@@@@@@@@#@@@@@@---=+-..-::..+:::.-------=--------
                            --+++++=+++----::=::.+-.=.:---::#@@@@@%@@@@@@@@@@@@@@@@@@%#@@@@@@*---==:..:::..=::.::---------------
                            --+++++=*++-----:+-..=+.=.:---:-@@@@@@=@@@@@@@@@@@@@@@@@%+@@@@@@@---==#...-.-..-::.:------=---------
                            =++++++=#+=----:.:-..::.:.:--::*@@@@@@%@@@@@@@@@@@@@@@@+@@@@@@@@%---==:..::.*..:-:.:-----=----------
                            -++++++=++-----+.=:.::..=.=--:-%@@@@@@#@@@@@@@@@@@@@@@#@@@@@@@@@%-:==+:..-....*:-::------=----------
                            =++++++==+-----%.--.:-....--::-@@@@@@@@+@@@@@@@@@@@%+%@@@@@@@@@@=--==+...-.=..+:-::------*----------
                            ++++++*==+-----:=::.*-.*.:--::*@@@@@@@@#@@@@@@@@@@##@@@@@@@@@@@@---===...-.:...::.:-----==----------
                            ++++++++++-----.+=..==.=.:-::-%@@@@@@@@@+@@@@@@@**@@@@@@@@@@@@@#---=*:..::.-..::..------=---------+-
                            ++++++++*=-----.:+.:.:.:.--::=@@@@@@@@@@@#@%%#%*@@@@@@@@@@@@@@@#-:==+...-..+.:::..=-----=--------++-
                            +++++++++-----:.::.=::.-.-:::#@@@@@@@@@@@*=%@@@@@@@@@@@@@@@@@@@=-:==+...-..-.#:...------+--------++=
                            +++++++++-----+.--.:::..:-::-@@@@@@@@@@@-%%%@@@@@@@@@@@@@@@@@@@---=--...:.:..+:...=-----+-------+++=
                            ++++++++*-----#.::.--.*.:-::=@@@@@@@@@@#@#@%+@@@@@@@@@@@@@@@@@%--==*...::.+...:...#-----=-------++++
                            ++++++++*=---:---..+=.#.--::%@@@@@@@@@@%##@@*@@@@@@@@@@@@@@@@@*--==*...:..=.-.:..:*----==------=++++
                            ++=++++++=----.+#..--.:.--:-@@@@@@@@@@%#@#%+@@@@@@@@@@@@@@@@@@*-:==:...-..:.:.:..:=----=-------+++++
                            +++=+++++*---+.=#.:.:..:-::=@@@@@@@@@@%#+*##@@@@@@@@@@@@@@@@@@+-:==-...=..:.:.:..------=------=+++++
                            +++==++++%---=.--.=::..--::@@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@---=-....=..-.+.:..=-----+------=+++++
                            ++++-=++++=---.:..=::..--:-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@---=#...::..=.*.:..+-----+-----=++++++
                            ++++--=++++--:.::.:::-.=-:=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*--==#...:...-.=::..=-----+----++++++++
                            +++++--=++*--:.::..-:%.--:%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:==-...-...:..:..:------+---+++++++++
                            +++++=--++*--:.:..-=:**--:%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:==-...-....:.:..:------+--++++++++++
                            ++++++--=++=-.::..=-.:*--=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@--:==-...:..:.=.:...=-----+=+++++++++++
                            ++++++=--=+=-.:-..=::.:-:+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@---==:...:..-.=.:..:+-----+++++++++++++
                            +++++++=--+++.-*..+::.--:*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%---=*....-..=.=.:..:*----=+++++++++++++
                            ++++++++=-=+*:-%..=::.---%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*-:-=%....-..+.-.:..:*---+*+++++++++++++
                            +++++++++=-+*--%..-:.---=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:-=%....=..+.:.:..:+--++*+++++++++++++
                            +++++++++==-++-*.:::-%--=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:-=+....-..=.:.:..:*-=++*+++++++++++++
                            ++++++++++=-==-=.-::*#--*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:-=:....-..-.:.:...*++++*+++++++++++++
                            ++++++++++==-=-=.=-:*---#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=-:-=.....-..:.:.:..:*++++++++++++++++++`, 'color: black; background-color: white; font-size: 8px; line-height: 1;')
                    </script>
                    <div class='container'>
                        <p>Você foi banido! Seu IP: <strong>$ip</strong></p>
                        <p>Se você acredita que isso é um erro, entre em contato com o suporte de T.I.</p>
                    </div>
                </body>
                </html>
            ");
        }
    }

    $total = count(array_filter($tentativas, fn($t) => $t['ip'] === $ip));

    if ($total >= $tentativasPermitidas) {
        bloquearIp($ip, $arquivo);
        die(" 
        <!DOCTYPE html>
        <html lang='pt-br'>
        <head>
            <meta charset='UTF-8'>
            <meta name='viewport' content='width=device-width, initial-scale=1.0'>
            <title>Acesso Bloqueado</title>
        </head>
        <body>
            <script>
                    console.log(`%c----------------------------------------------------------------------------------------------------
                    ----------------------------------------------------------------------------------------------------
                    ----------------------------------------------------------------------------------------------------
                    ----------------------------------------------------------------------------------------------------
                    -------------------------*--------------------------------------------------------------------------
                    -------------------------=***-----------------------------------------------------------------------
                    ------------------------+-****++--------------------------------------------------------------------
                    ------------------------=*+******#**++--------------------------------------------------------------
                    -------------------------+************#%+=----------------------------------------------------------
                    ---------------+----------+**************#%==*------------------------------------------------------
                    ---------------##---+=-----*****************##*%=---------------------------------------------------
                    ---------------+#**-=****=-=******************###+--------------------------------------------------
                    ----------------%#**=#******##*******************#*=------------------------------------------------
                    ----------------%%##***#*****##*******************#=*-----------------------------------------------
                    ----------------#%%%##*####****#*********************=----------------------------------------------
                    ----------------#%%%%#*#%%%##**##*********************----------------------------------------------
                    ---------------+#%%%%%%#%%%%%%#####*******************#---------------------------------------------
                    ---------------++%%%%%%%%%%%%%%##%##*******************+--------------------------------------------
                    -----------------%%%%%%%%%%%%%%%%%%%*******************#--------------------------------------------
                    -----------------#%%%%%%%%%%%%%%%%%%#*******************+-------------------------------------------
                    ----------------*+%%%%%%%%%%%%%%%%%%#********************-------------------------------------------
                    ------------------#%%%%%%%%%%%%%%%%%#********************=------------------------------------------
                    ----------------+==%%%%%%%%%%%%%%%%%%*********************------------------------------------------
                    -----------------%++%%%%%%%%%%%%%%%%%#********************------------------------------------------
                    -----------------#%%%%%%%%%%%%%%%%%%%#********************-+=---------------------------------------
                    -----------------=%%%%%%%%%%%%%%%%%%%#***#####************=#----------------------------------------
                    ------------------+%%%%%%%%%%%%%%%%%%#***####************##%----------------------------------------
                    ------------------=*%%%%%%%%%%%%%%%%%#**####***##******#%%%*-=--------------------------------------
                    -------------------=+%%%%%%%%%%%%%%%%#*#####*####****#%%%%%*#+--------------------------------------
                    ------------------+---%%%%%%%%%%%%%%%#*######%%#***##%%##%%%*---------------------------------------
                    -------------------#=--#%%%%%%%%%%%%%###%###%%#*##%%%#*--=#-----------------------------------------
                    --------------------+%**#%%%%%%%%%%%%#%%%#%%%*##%%%%%-----------------------------------------------
                    -------------------*-=%%#%%%%%%%%%%%%%%%#%%%##%%%%*=-------=----------------------------------------
                    --------------------*+-*%%%%%%%%%%%%%%%%%%%##%%%+---+-------+---------------------------------------
                    ---------------------==+**%%%%%%%%%%%%%%%%%###+------=-=-==-----------------------------------------
                    -----------------------=+#%%%%%%%%%%%%%%%#+#+-------:-=---:--+--------------------------------------
                    -------------------------=+#%%%%%#%%%%%%*++=---:----::----*-----------------------------------------
                    -------------------------==+#%%%%%**#%#++=:-------------=----==-------------------------------------
                    --------------------------+++++*%%%%%#++=--:----:---------:--:--------------------------------------
                    --------------------------++++++++++++++---------===--:-=-=-==-=------------------------------------
                    --------------------------+++++++++++++=-:------=-----:--+::::-+------------------------------------
                    --------------------------+++++++++++++=:------=-+***%*==--==--=------------------------------------
                    --------------------------=++++++++++++=------:=%*==-=+=------=+------------------------------------
                    ---------------------------++++++++++++=:-----+#--::::::--+----+=-----------------------------------
                    ---------------------------++++++++++++=:--:-*#=-------:----*-+++-----------------------------------
                    --------------------------++++++++++++++:-:-%#=--:---:-----*==-+------------------------------------
                    --------------------------=+++++++++++==---%%*++---===-:----=---=-----------------------------------
                    --------------------------=#####+++++===-:##***=*##*##-------==-==:::..:----------------------------
                    --------------------------=*++*#%##+=-+:-=++**+*=%#=---:-----=+--*-----:::=-------------------------
                    --------------------------=-+++++**%#**::-=++*+-++*=----------====+++=----:-------------------------
                    ---------------------------#++++==+***+--:==-===--------------=---@@@@@@%=-.+-----------------------
                    ---------------------------=+*+=+=+***+:::-===----------------=--+%@@@@@@@*-.+----------------------
                    ----------------------------=++%#@%%+*+:-----:-:::--::---------+-=%-===@@@@%..----------------------
                    -----------------------------+#-=%#===+----:-:----------------=--:+----=+@@@..----------------------
                    ----------------------------=+***=--=++::---=-:--------------=+--:+----===%@..----------------------
                    ----------------------------*=++++=====+---------------------=++-:=---=====#..----------------------
                    ----------------------------%=+++++====*:----:::------------=-*==*----=====-..----------------------
                    ----------------------------#=++++===-=*--:-------------------=-------=====...----------------------
                    ----------------------------===-------+---:-----------------=-=-------=====..+----------------------
                    -----------------------------=+------=*--------------------=--=-------====..:-----------------------
                    ---------------------------#%=+=-----=+-:------=----------==-:+-------==+..:------------------------
                    --------------------*=--=#%@%=++=---=++-:-:-++-+:--------==:-:=------===...--+----------------------
                    ------------------=+---*@@@@%%=++====+#=-:-*=-+--------:-=-:-:+------==...---=----------------------
                    ----------------=+---*@@@@@@#-==+++++++=-++=:::-:::----:--:---+----==:..:---------------------------
                    --------------=#---+@@@@@@#-----=+++++++++++---:--------------+=--+-...:----+-----------------------
                    -------------*----@@@@@@%-------==+++++++=++-----------------+*#--=...------+-----------------------
                    -----------*----%@@@@@@=---------+-+++++==+=---------:-------+%+---:.+------*-----------------------
                    ----------=---#@@@@@@+=----------=-==+++=-=-=**=--=++--------+==-=----------+-----------------------
                    --------*---+%@@@@@*===------------=+=++==++======*=--------=++%-#--=-------------------------------
                    ------=+---*@@@@@#=====------------+=++++++=++++++-=--------++==-*--=-------------------------------
                    -----=----%@@@@@=======-------------+=###*+#++===:-=-------=+==+=*--=--------+=---------------------
                    -----*----@@@@@@=========------------==+*+++======+--------*++--+#--:--------+=*=-------------------
                    -----*---+@@@@@#=========-=-----------=-*+++=====*--------++++--+*--..:-----==---=:-----------------
                    -----+---%@@@@@===========---------------+=+**++-:--------++*-----=-..+-----==---.------------------
                    ---------*@@@@@+=============------------+++++=--=+*:----+++#-----==..-----====-+.:*+---------------
                    -------=--#@@@@@+============-----------==++=---:-:-:---=++++-----*=..:----+==+-=..-.+--------------
                    --------=--+****-*===========----------=--++-:-:--------*+++=-----*-..:---+==+=-=.::..=-------------
                    ---------=--------*============-------+--+=+--------:--+++++------+=:.:---+=+==-=.::..+-------------
                    ----------*--------*===========-----=+--=+*-=-------::+*+++*------==:..--+=++-==+..-..:::+----------
                    -----------+=-------+===========----+---*+++=-------:=*++++--------=-:.--=++-==:..:-..-..+-=--------
                    -------------*------+=============-+---*++++*=--::--**=++++--------=-:=-==+=-=-:..-..:::.---==------
                    --------------=-----+=============+----+++++-=#++=+*+--+++=--------+---==+=-==-..==..:-..-----+-----
                    ---------------=----++===========+----++++++=-+++*+==-++++--:------+-:-+++--=+..--:.=::..+-----==---
                    -----------------=---=*=========*-----=++++++--+++++==++*----------=-:-++--==...-=..=--.:--------=+-
                    ---------------+-==----+=======*------=++++++=-+++++++++*----:-----=---+--===..-:-..+::.-----------+
                    ----------------=+==----*=======------+++++++++++++++++#-----------==--+--=+...:::..:*.::----------+
                    -------------+-++===.----=+====------==++++++++++++++++=-----------*=-:--===..::+..+:..:------------
                    -----------+-=++===-.-*:-------------+++++++++++++++++=-----------+#=----=+...-:-..:.::------------*
                    --------#=-=++=====::::=------------#*#+++++++++++++++------------%%=-:--==...:-..::=.-:-----------+
                    -----=====+++=====+.*:.*------------%*%-=+===+#++++++-----------*@*@----==-..*:+..=::.:-----------+-
                    ------=+++++=======::=.-:+---------*@%@+-::----+*++++----------*@*%*-:--=*..::.:.::...-----------+--
                    ---==++++++=---===:-::.-+.+--------%@%@@=::------+++====------#@*@@+---==-..:::..::-.::---------*---
                    ----+++++++=----=*.=-..-:.:=-------@@%@@@+----:---:---===#=--%@*@@@--:-==:..*:#..=::.----------*----
                    --==+++++++=---=-=.--.::=.:=------%@@%@@@@@-::----------====%@#@@@@----=%..::....::..:--------*-----
                    --:++++++++=---=-:=:-.=-.-.=----:-@@@%@@@@@@%-:------::-:*%%@@*@@@#---==-..::...=:...--------=------
                    ---++++++++------:--..-*.:.*----:=@@@%@@@@@@@@%#+::--:=#%@@@@*@@@@=---==:..=:+..-.:.::------=-------
                    -=-++++++++=----=.=-..::.=.#---:-@@@@*@@@@@@@@@@@@@%@@@@@@@@*@@@@@=--==#...:.+..-::.=------=--------
                    -+-++++#+++=----#.=-..:-.-.=---:=@@@@*@@@@@@@@@@@@@@@@@@@@@#@@@@@@---=+-..-::..+:::.-------=--------
                    --+++++=+++----::=::.+-.=.:---::#@@@@@%@@@@@@@@@@@@@@@@@@%#@@@@@@*---==:..:::..=::.::---------------
                    --+++++=*++-----:+-..=+.=.:---:-@@@@@@=@@@@@@@@@@@@@@@@@%+@@@@@@@---==#...-.-..-::.:------=---------
                    =++++++=#+=----:.:-..::.:.:--::*@@@@@@%@@@@@@@@@@@@@@@@+@@@@@@@@%---==:..::.*..:-:.:-----=----------
                    -++++++=++-----+.=:.::..=.=--:-%@@@@@@#@@@@@@@@@@@@@@@#@@@@@@@@@%-:==+:..-....*:-::------=----------
                    =++++++==+-----%.--.:-....--::-@@@@@@@@+@@@@@@@@@@@%+%@@@@@@@@@@=--==+...-.=..+:-::------*----------
                    ++++++*==+-----:=::.*-.*.:--::*@@@@@@@@#@@@@@@@@@@##@@@@@@@@@@@@---===...-.:...::.:-----==----------
                    ++++++++++-----.+=..==.=.:-::-%@@@@@@@@@+@@@@@@@**@@@@@@@@@@@@@#---=*:..::.-..::..------=---------+-
                    ++++++++*=-----.:+.:.:.:.--::=@@@@@@@@@@@#@%%#%*@@@@@@@@@@@@@@@#-:==+...-..+.:::..=-----=--------++-
                    +++++++++-----:.::.=::.-.-:::#@@@@@@@@@@@*=%@@@@@@@@@@@@@@@@@@@=-:==+...-..-.#:...------+--------++=
                    +++++++++-----+.--.:::..:-::-@@@@@@@@@@@-%%%@@@@@@@@@@@@@@@@@@@---=--...:.:..+:...=-----+-------+++=
                    ++++++++*-----#.::.--.*.:-::=@@@@@@@@@@#@#@%+@@@@@@@@@@@@@@@@@%--==*...::.+...:...#-----=-------++++
                    ++++++++*=---:---..+=.#.--::%@@@@@@@@@@%##@@*@@@@@@@@@@@@@@@@@*--==*...:..=.-.:..:*----==------=++++
                    ++=++++++=----.+#..--.:.--:-@@@@@@@@@@%#@#%+@@@@@@@@@@@@@@@@@@*-:==:...-..:.:.:..:=----=-------+++++
                    +++=+++++*---+.=#.:.:..:-::=@@@@@@@@@@%#+*##@@@@@@@@@@@@@@@@@@+-:==-...=..:.:.:..------=------=+++++
                    +++==++++%---=.--.=::..--::@@@@@@@@@@@@@@@%@@@@@@@@@@@@@@@@@@@---=-....=..-.+.:..=-----+------=+++++
                    ++++-=++++=---.:..=::..--:-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@---=#...::..=.*.:..+-----+-----=++++++
                    ++++--=++++--:.::.:::-.=-:=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*--==#...:...-.=::..=-----+----++++++++
                    +++++--=++*--:.::..-:%.--:%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:==-...-...:..:..:------+---+++++++++
                    +++++=--++*--:.:..-=:**--:%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:==-...-....:.:..:------+--++++++++++
                    ++++++--=++=-.::..=-.:*--=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@--:==-...:..:.=.:...=-----+=+++++++++++
                    ++++++=--=+=-.:-..=::.:-:+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@---==:...:..-.=.:..:+-----+++++++++++++
                    +++++++=--+++.-*..+::.--:*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%---=*....-..=.=.:..:*----=+++++++++++++
                    ++++++++=-=+*:-%..=::.---%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*-:-=%....-..+.-.:..:*---+*+++++++++++++
                    +++++++++=-+*--%..-:.---=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:-=%....=..+.:.:..:+--++*+++++++++++++
                    +++++++++==-++-*.:::-%--=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:-=+....-..=.:.:..:*-=++*+++++++++++++
                    ++++++++++=-==-=.-::*#--*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+-:-=:....-..-.:.:...*++++*+++++++++++++
                    ++++++++++==-=-=.=-:*---#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@=-:-=.....-..:.:.:..:*++++++++++++++++++`, 'color: red; background-color: black; font-size: 8px; line-height: 1;')
            </script>
            <div class='container'>
                <p>Você foi banido! Seu IP: <strong>$ip</strong></p>
                <p>Se você acredita que isso é um erro, entre em contato com o suporte de T.I.</p>
            </div>
        </body>
        </html>
    ");
    }
}

function registrarTentativaArquivo($ip) {
    $arquivo = __DIR__ . '/tentativas_logs.txt';

    if (!file_exists($arquivo)) {
        file_put_contents($arquivo, json_encode([]));
    }

    $tentativas = json_decode(file_get_contents($arquivo), true) ?? [];
    $tentativas[] = ['ip' => $ip, 'hora' => time()];

    file_put_contents($arquivo, json_encode($tentativas), LOCK_EX);
}

function bloquearIp($ip, $arquivo) {
    $tentativas = json_decode(file_get_contents($arquivo), true) ?? [];

    $tentativas[] = ['ip' => $ip, 'bloqueado' => true, 'hora' => time()];

    file_put_contents($arquivo, json_encode($tentativas), LOCK_EX);

    $logFile = __DIR__ . '/ip_banido.txt';
    $logData = "IP Bloqueado: $ip | Hora: " . date('Y-m-d H:i:s') . "\n";
    file_put_contents($logFile, $logData, FILE_APPEND | LOCK_EX);
}
?>
